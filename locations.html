<!DOCTYPE html>
<html>
<head>
  <title>Parking Locations Summary</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      text-align: center;
    }
    .card {
      border: 1px solid #ccc;
      padding: 15px;
      margin: 12px;
      border-radius: 8px;
      width: 280px;
      display: inline-block;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .available {
      color: green;
      font-weight: bold;
    }
    .occupied {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h2>üöó Parking Locations Overview</h2>
<div id="list"></div>

<script>
// üîπ CSV link (same as slot page)
const sheetURL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vSwLmApnYXq3_ayIB9AsRG9le-HXu4Fl62bXK3ySXnqoikhxGSz9lhsxREz83qjUtrp5KAKEH-o4vL7/pub?output=csv";

function loadLocationData() {
  fetch(sheetURL + "&t=" + Date.now()) // üî• cache-busting
    .then(res => res.text())
    .then(csv => {
      const rows = csv.trim().split("\n");
      if (rows.length < 2) return;

      const cells = rows[1].split(",");

      const place = cells[0];
      const totalSlots = 4;

      let availableSlots = 0;
      let occupiedSlots = 0;

      // Slot-wise evaluation
      for (let i = 1; i <= 7; i += 2) {
        const status = cells[i];     // SlotX_Status
        const booked = cells[i + 1]; // SlotX_Booked

        if (booked === "YES" || status === "FILLED") {
          occupiedSlots++;
        } else {
          availableSlots++;
        }
      }

      const container = document.getElementById("list");
      container.innerHTML = ""; // clear old data

      const div = document.createElement("div");
      div.className = "card";

      div.innerHTML = `
        <h3>üìç ${place}</h3>
        <p>Total Slots: <b>${totalSlots}</b></p>
        <p class="available">Available: ${availableSlots}</p>
        <p class="occupied">Occupied / Booked: ${occupiedSlots}</p>
      `;

      container.appendChild(div);
    })
    .catch(err => console.error("Location CSV error:", err));
}

// Initial load
loadLocationData();

// Auto-refresh every 15 seconds
setInterval(loadLocationData, 15000);
</script>

</body>
</html>
